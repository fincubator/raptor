<html><head><base href="https://validatorlauncher.com/"><title>Validator Launcher with Keplr Integration</title><style>
body {
  font-family: 'Roboto', sans-serif;
  background-color: #0a0e1a;
  color: #e0e0e0;
  margin: 0;
  padding: 20px;
}
header {
  text-align: center;
  margin-bottom: 30px;
}
h1 {
  color: #8e44ad;
}
.container {
  max-width: 800px;
  margin: 0 auto;
}
.validator-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px;
}
.validator-card {
  background-color: #1a1f35;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.validator-logo {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  margin-bottom: 10px;
}
.validator-name {
  font-size: 1.2em;
  font-weight: bold;
  margin-bottom: 5px;
}
.validator-chain {
  font-size: 0.9em;
  color: #3498db;
  margin-bottom: 10px;
}
.validator-stats {
  font-size: 0.9em;
  margin-bottom: 15px;
}
.connect-btn, .telegram-btn {
  background-color: #8e44ad;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
  text-decoration: none;
  display: inline-block;
  margin: 5px;
}
.connect-btn:hover, .telegram-btn:hover {
  background-color: #9b59b6;
}
.telegram-btn {
  background-color: #0088cc;
}
.telegram-btn:hover {
  background-color: #0099dd;
}
.authz-form {
  margin-top: 20px;
}
.authz-form input {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 5px;
  border: 1px solid #444;
  background-color: #2c3e50;
  color: #fff;
}
.authz-form button {
  background-color: #27ae60;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
}
.authz-form button:hover {
  background-color: #2ecc71;
}
</style></head><body>
  <header>
    <h1>Validator Launcher</h1>
    <button id="connect-keplr" class="connect-btn">Connect Keplr</button>
    <a href="https://t.me/ValidatorLauncherBot" target="_blank" class="telegram-btn">Telegram Bot</a>
  </header>
  
  <div class="container">
    <div class="validator-list">
      <div class="validator-card">
        <img src="https://example.com/posthuman-logo.png" alt="POSTHUMAN Logo" class="validator-logo" width="80" height="80">
        <div class="validator-name">POSTHUMAN</div>
        <div class="validator-chain">Celestia Network (TIA)</div>
        <div class="validator-stats">
          Voting Power: 2,345,678<br>
          Commission: 5%<br>
          Uptime: 99.99%
        </div>
        <form class="authz-form" method="GET" action="https://validatorlauncher.com/authz">
          <input type="hidden" name="validator" value="celestia1zwjfxr3j9gnnrhxwtt8t6qqr4pdn7cgj33hd7c">
          <input type="hidden" name="grant_type" value="redelegate">
          <input type="text" name="max_tokens" placeholder="Max Tokens">
          <input type="text" name="referral_code" placeholder="Referral Code (Optional)">
          <button type="submit">Send Redelegate Authz</button>
        </form>
      </div>
      
      <div class="validator-card">
        <img src="https://example.com/finteh-logo.png" alt="Finteh Logo" class="validator-logo" width="80" height="80">
        <div class="validator-name">Finteh</div>
        <div class="validator-chain">Fetch.ai Network (FET)</div>
        <div class="validator-stats">
          Voting Power: 1,876,543<br>
          Commission: 7%<br>
          Uptime: 99.98%
        </div>
        <form class="authz-form" method="GET" action="https://validatorlauncher.com/authz">
          <input type="hidden" name="validator" value="fetchvaloper1...">
          <input type="hidden" name="grant_type" value="redelegate">
          <input type="text" name="max_tokens" placeholder="Max Tokens">
          <input type="text" name="referral_code" placeholder="Referral Code (Optional)">
          <button type="submit">Send Redelegate Authz</button>
        </form>
      </div>
    </div>
  </div>

    <script type="module">
import * as tx from "https://cdn.skypack.dev/cosmjs-types/cosmos/authz/v1beta1/tx";
import * as authz from "https://cdn.skypack.dev/cosmjs-types/cosmos/authz/v1beta1/authz";




    document.getElementById('connect-keplr').addEventListener('click', async () => {
      if (!window.keplr) {
        alert("Please install Keplr extension");
        return;
      }
      
      try {
        await window.keplr.enable('celestia');
        const offlineSigner = window.keplr.getOfflineSigner('celestia');
        const accounts = await offlineSigner.getAccounts();
        
        alert(`Connected with address: ${accounts[0].address}`);
      } catch (error) {
        console.error("Failed to connect to Keplr:", error);
        alert("Failed to connect to Keplr. Please try again.");
      }
    });

document.querySelectorAll('.authz-form').forEach(form => {
  form.addEventListener('submit', async (event) => {
    event.preventDefault();
    
    if (!window.keplr) {
      alert("Please install Keplr extension");
      return;
    }

    const validator = form.querySelector('input[name="validator"]').value;
    const maxTokens = form.querySelector('input[name="max_tokens"]').value;
    const referralCode = form.querySelector('input[name="referral_code"]').value;
    const chain = form.closest('.validator-card').querySelector('.validator-chain').textContent;

    try {
      const chainId = chain.includes('Celestia') ? 'celestia' : 
                      chain.includes('Fetch.ai') ? 'fetchhub-4' : 'unknown';

      await window.keplr.enable(chainId);
      const offlineSigner = window.keplr.getOfflineSigner(chainId);
      console.log(offlineSigner);
      const accounts = await offlineSigner.getAccounts();
      console.log(accounts);
      // Fetch account details
const { accountNumber, sequence } = await window.keplr.getKey(chainId);
console.log(sequence);
const accountData = await fetch("https://rest.cosmos.directory/celestia" + "/cosmos/auth/v1beta1/accounts/"+accounts[0].address). then(data => data.json())

console.log("accountData",accountData)
      const msg = {
      "type": "cosmos-sdk/MsgGrant",
      "value": {
        "granter": accounts[0].address,
        "grantee": validator,
        "grant": {
          "authorization": {
            "type": "cosmos-sdk/StakeAuthorization",
            "value": {
              "Validators": {
                "type": "cosmos-sdk/StakeAuthorization/AllowList",
                "value": {
                  "allow_list": {
                    "address": [
                      "celestiavaloper1snun9qqk9eussvyhkqm03lz6f265ekhnnlw043"
                    ]
                  },
                  maxTokens: {
                  denom: 'utia',
                  amount: '100000000'
                },
                  "authorization_type": 999999
                }
              },
              }
          },
          "expiration": new Date(Date.now() + 365 * 24 * 60 * 60 * 1000) // 365 days from now
          }
        }
      };

      const fee = {
        amount: [{ denom: "uatom", amount: "5000" }],
        gas: "200000",
      };

      const signDoc = {
  chain_id: chainId,
  account_number: accountData.account.account_number, // You may need to fetch this
 sequence: accountData.account.sequence, // You may need to fetch this
  fee: fee,
  msgs: [msg],
  memo: ''
};

const signResponse = await window.keplr.signAmino(chainId, accounts[0].address, signDoc);

const result = await window.keplr.sendTx(chainId, accounts[0].address, signResponse)      
      console.log("Transaction result:", result);
      alert(`Redelegate authz transaction sent for ${chain}! Transaction hash: ${result.transactionHash}`);
    } catch (error) {
      console.error("Failed to send redelegate authz transaction:", error);
      alert("Failed to send redelegate authz transaction. Please try again.");
    }
  });
});



  </script>
</body></html>
